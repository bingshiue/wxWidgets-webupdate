<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>WebUpdate: The WebUpdate tutorial</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.2 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<div class="nav">
<a class="el" href="docs_8txt.html">docs.txt</a></div>
<h1><a class="anchor" name="tutorial">The WebUpdate tutorial</a></h1><h2><a class="anchor" name="defs">
Basic WebUpdate concepts</a></h2>
Before using this component, you need to know some few definitions of the terms used in all WebUpdate documentation:<ul>
<li>the WebUpdate project provides both a library and an executable, which is called '<b>WebUpdater</b>' or just '<b>updater</b>'. The library is used only for some advanced things and for simple programs you will typically need to use only the 'updater' copying the executable file in your program's folder. For more info about the design of the WebUpdate component, look at the <a class="el" href="faq.html">FAQ page</a>...</li></ul>
<p>
<ul>
<li>a '<b>package</b>' is a set of files which have in common their function (or maybe their location in the program's folder structure) and are packaged in a single archive. A 'remote package' is an archive hosted in the webserver for download. A 'local package' is a package which is installed in the user's system (typically 'installed' means 'uncompressed'). The C++ classes used by WebUpdate to work on local &amp; remote packages are <a class="el" href="classwxWebUpdateLocalPackage.html">wxWebUpdateLocalPackage</a> and <a class="el" href="classwxWebUpdatePackage.html">wxWebUpdatePackage</a>, respectively.</li></ul>
<p>
<ul>
<li>a '<b>download</b>' is the compressed file which holds the remote package files. A single remote package can have many downloads; typically one per targeted platform even if a single download can be used by more than a single platform. The C++ class used to store a 'download' is <a class="el" href="classwxWebUpdateDownload.html">wxWebUpdateDownload</a>.</li></ul>
<p>
<ul>
<li>an '<b>action</b>' is one of the command to execute after the complete download of a package (i.e. after the download of the package's 'download' for the current platform). There are some predefined actions: <a class="el" href="classwxWebUpdateActionRun.html">wxWebUpdateActionRun</a>, <a class="el" href="classwxWebUpdateActionExtract.html">wxWebUpdateActionExtract</a>, wxWebUpdateActionMake, <a class="el" href="classwxWebUpdateActionOpen.html">wxWebUpdateActionOpen</a>... Their base class is <a class="el" href="classwxWebUpdateAction.html">wxWebUpdateAction</a>. You can define your own customized actions deriving a new class from <a class="el" href="classwxWebUpdateAction.html">wxWebUpdateAction</a>. For more info about creation of your custom actions, see <a class="el" href="customaction.html">How to create a new custom action</a> page.</li></ul>
<p>
<ul>
<li>the '<b>local XML script</b>' is the XML file which contains the configuration settings for the WebUpdater application and also the versions and the list of the local packages currently installed. The C++ class for local XML scripts is <a class="el" href="classwxWebUpdateLocalXMLScript.html">wxWebUpdateLocalXMLScript</a>.</li></ul>
<p>
<ul>
<li>the '<b>remote XML script</b>' is slightly more complex rather than the local XML script because it contains all the info about the remote packages in the webserver (specially their versions) and the info about their installation. The C++ class for remote XML scripts is <a class="el" href="classwxWebUpdateXMLScript.html">wxWebUpdateXMLScript</a>.</li></ul>
<p>
&lt;br/&gt;<h2><a class="anchor" name="howto_integrate">
How to integrate WebUpdate in your application</a></h2>
It's quite easy to use WebUpdate in your programs following these simple steps:<p>
1) <b>Plan your "update strategies"</b>: do you need more than a single package ? Which files will belong to each package ? Which format are you going to use for your packages: simple archives (ZIP, TAR.GZ, ...) or installers (MSI, RPM, DEB) ? Which actions will you need to perform such updates ?<p>
Try to keep things as simple as possible; also you should not think to the action tags as a complete set of installer directives. In fact, if you need special or platform-dependent actions then you should use some kind of script in the downloaded file (MSI, RPM, DEB all provide a much more complete set of possible actions) and then use the WebUpdater just to run those scripts / installers.<p>
Another thing to consider is: how much often will you make a new release ? If you often make new releases then you should try to keep the files which need to be updated separed (i.e. in a different package) from those files which instead probably won't need updates. In this way the packages which will be downloaded by the user will be smaller and thus updates will be faster (and the user happier).<p>
On the other hand, if you often make releases or have few time to do the packaging, and your program is not so big, you should consider to create a single package for each platform which will work both as installer for the user who downloads your program for the first time and also as update for the users using WebUpdater.<p>
2) <b>Write your 'local.xml' file</b>: this is the simplest XML used by WebUpdate; it looks like:<p>
<div class="fragment"><pre class="fragment">&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;!-- the Document Type Definition (DTD) for a local XML WebUpdate script
     is located at
     
        http://wxcode.sourceforge.net/components/webupdate/local.dtd  
   
     as the following tag says to the XML parsers.
--&gt;
&lt;!DOCTYPE webupdate PUBLIC "-//WebUpdate//DTD WebUpdater 1.0//EN" 
	"http://wxcode.sourceforge.net/components/webupdate/local.dtd"&gt;
	
	
&lt;!-- NOTE: all the comments located in local XML scripts will be lost
     after the first update by WebUpdater since it overwrites this file
     and don't save the comments, too.
--&gt;


&lt;!-- The &lt;webupdate&gt; tag is the root of the local XML script.
     Every info is contained inside it.
     You should always specify as property of this tag the version
     of this local XML script. --&gt;
&lt;webupdate version="1.0"&gt;

    
      &lt;!-- some settings about the application to update... --&gt;
      &lt;appname&gt;AppName&lt;/appname&gt;
      &lt;appfile&gt;myprogram&lt;/appfile&gt;
      
      
      &lt;!-- ...about the XRC resource name to use for webupdater... --&gt;
      &lt;dlgxrc&gt;wxWebUpdateDlg&lt;/dlgxrc&gt;
      
      
      &lt;!-- ...where to find the list of updated packages ... --&gt;
      &lt;remoteuri&gt;http://myserver/updates/list.xml&lt;/remoteuri&gt;
      
      
      &lt;!-- ...the list of the local packages --&gt;
      &lt;local-package id="core"&gt;
        &lt;version&gt;1.0.0&lt;/version&gt;
      &lt;/local-package&gt;
      &lt;local-package id="addon1"&gt;
        &lt;version&gt;1.0.0&lt;/version&gt;
      &lt;/local-package&gt;
      &lt;local-package id="addon2"&gt;
        &lt;version&gt;1.0.0&lt;/version&gt;
      &lt;/local-package&gt;
      
      
      &lt;!-- the list can be as long as you need... --&gt;
      ...
      
      
      &lt;!-- if you want to be able to update the updater, you should include this
           package in the list (see the WebUpdate documentation for more info) --&gt;
      &lt;local-package id="WebUpdater"&gt;
        &lt;version&gt;1.0.0&lt;/version&gt;
      &lt;/local-package&gt;
  
&lt;/webupdate&gt;
</pre></div><p>
For the complete reference to the tags that you can use in this XML file, you should look at <a class="el" href="localdtd.html">The Local XML WebUpdate DTD</a> (even if you don't know the DTD syntax it should be quite easy to understand what is allowed and what is not...).<p>
3) <b>Write your 'remote.xml' file</b>: this is a bit more complex and contains all the important info about the updated packages. It looks like:<p>
<div class="fragment"><pre class="fragment">&lt;?xml version="1.0"?&gt;

&lt;!-- the Document Type Definition (DTD) for a remote XML WebUpdate script
     is located at
     
        http://wxcode.sourceforge.net/components/webupdate/remote.dtd  
   
     as the following tag says to the XML parsers.
--&gt;
&lt;!DOCTYPE webupdate PUBLIC "-//WebUpdate//DTD WebUpdater 1.0//EN" 
	"http://wxcode.sourceforge.net/components/webupdate/remote.dtd"&gt;


&lt;!-- The &lt;webupdate&gt; tag is the root of the local XML script.
     Every info is contained inside it.
     You should always specify as property of this tag the version
     of this local XML script. --&gt;
&lt;webupdate version="1.0"&gt;


   &lt;!-- all the info about a specific package are enclose in the &lt;package&gt; tag --&gt;
   &lt;package id="simple"&gt;
   
      &lt;!-- the most important is the latest version available for this package --&gt;
      &lt;latest-version importance="high"&gt;2.0.3&lt;/latest-version&gt;
      
      &lt;!-- then comes the donwload URLs... --&gt;
      &lt;latest-download&gt;
			&lt;uri&gt;http://myserver/updates/simple.zip&lt;/uri&gt;
            
            &lt;!-- each 'download' can be for one or more specific platform(s) or for
                 all platforms (using "any") --&gt;
			&lt;platform name="msw"/&gt;	
            
            &lt;!-- now you need to tell to WebUpdater how to install this package... --&gt;
			&lt;actions&gt;
            
                &lt;!-- the EXTRACT action is one of the predefined actions... --&gt;
				&lt;extract file="$(thisfile)" where="$(programdir)"/&gt;
			&lt;/actions&gt;
	  &lt;/latest-download&gt;
      
      &lt;!-- another download... --&gt;
      &lt;latest-download&gt;
			&lt;uri&gt;http://myserver/updates/simple.tar.gz&lt;/uri&gt;
            
            &lt;!-- ... for another platform --&gt;
			&lt;platform name="gtk"/&gt;
            
			&lt;actions&gt;
            
                &lt;!-- just "run" this file after the download: i.e. open it with
                     the default application for this file type --&gt;
   				&lt;run/&gt;
       		&lt;/actions&gt;
	  &lt;/latest-download&gt;
      
      &lt;!-- description is a package-specific property... --&gt;
	  &lt;description&gt;This is a simple package with two downloads !&lt;/description&gt;
   &lt;/package&gt;


   &lt;!-- other package definitions follow... --&gt;
   ...
   
   
   &lt;!-- if you want to be able to update the updater, you should include this
       package in the list (see the WebUpdate documentation for more info) --&gt;
   &lt;package id="WebUpdater"&gt;
      &lt;latest-version importance="high"&gt;XXX&lt;/latest-version&gt;
      &lt;latest-download&gt;
			&lt;uri&gt;https://sourceforge.net/project/showfiles.php?group_id=51305&amp;package_id=45182&lt;/uri&gt;
			&lt;platform name="msw"/&gt;
			&lt;md5&gt;&lt;/md5&gt;
			&lt;actions&gt;&lt;extract file="$(thisfile)" where="$(programdir)"/&gt;&lt;/actions&gt;
	  &lt;/latest-download&gt;
	  &lt;description&gt;The WebUpdater program that you are currently running.&lt;/description&gt;
   &lt;/package&gt;
   
&lt;/webupdate&gt;
</pre></div><p>
Like for the local scripts, for the complete reference to the tags that you can use in this XML file, you should look at <a class="el" href="remotedtd.html">The Remote XML WebUpdate DTD</a> .<p>
4) <b>Create your packages</b>: now, you should create the archives/installers that you planned to use as update packages. WebUpdate does not require any special hack to be included in your packages (like the filelist or other ugly things). It just requires that, if you want to use the &lt;extract&gt; action, you use one of the wxWidgets-supported archive types (look at <a class="el" href="remotedtd.html">The Remote XML WebUpdate DTD</a> for more info).<p>
After the creation of the packages, you should just upload them in the right places. Also take in count that while you are testing the update system you can put the packages in your hard disk and then use in the &lt;remoteuri&gt; and &lt;uri&gt; tags of the local &amp; remote XML scripts local URIs (e.g. &lt;uri&gt; <a href="file:c:/simple.zip \</uri">file:c:/simple.zip \&lt;/uri</a>&gt;) instead of the remote ones; this allows you to test the update system also when you are offline and, most important, to test it quickly (since downloads are usually slower than hard disk accesses !).<p>
5) <b>Modify your program to use WebUpdater</b>: this is the 'real' integration step. The changes to your app are very small:<ul>
<li>somewhere (typically in the handler of a menu command) you should put an execute istruction to run <code>"./webupdater"</code> (on unix) or <code>"webupdater.exe"</code> (on win32). You can see how to do this using wxWidgets in the WebUpdate samples.</li></ul>
<p>
<ul>
<li>just after the call to <code>"webupdater(.exe)"</code> you should add an exit istruction; that is, just after that your program has run the updater, it must also exit. This is because the updater will probably need to replace your program's executable or other files locked by your program... and this cannot be done until the program-to-update is running. See the <a class="el" href="faq.html">The Frequently Asked Questions about WebUpdate</a> for more info.</li></ul>
<p>
Then, just compile WebUpdater (or download its binary distribution) and put the executable file in your program's root folder. That's it !<p>
5) <b>Test your update system</b>: just run your program and see if it correctly runs the WebUpdater. Once the webupdater is running you should verify that your application did exit. Then you can test your XML remote script (the local script is loaded immediately when webupdater starts), the remote packages and the installation actions just acting as the user of your program would do.<p>
This should be enough to use the WebUpdate component. For a soft approach you could also prefer to look directly to the samples of WebUpdate. In this case first look at <a class="el" href="samples.html">The samples of WebUpdate</a> page.<p>
Last: if you think something is missing from this tutorial or from the documentation, then just mail me at "frm AT users.sourceforge.net". <hr size="1"><address style="align: right;"><small>Generated on Sat Nov 12 14:55:57 2005 for WebUpdate by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.2 </small></address>
</body>
</html>
