<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>WebUpdate: webupdate.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.2 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<div class="nav">
<a class="el" href="dir_000001.html">include</a>&nbsp;/&nbsp;<a class="el" href="dir_000002.html">wx</a></div>
<h1>webupdate.h</h1><a href="webupdate_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 
00002 <span class="comment">// Name:        webupdate.h</span>
00003 <span class="comment">// Purpose:     wxWebUpdateXMLScript, wxWebUpdatePackage, wxWebUpdateDownload</span>
00004 <span class="comment">// Author:      Francesco Montorsi</span>
00005 <span class="comment">// Created:     2005/06/23</span>
00006 <span class="comment">// RCS-ID:      $Id: webupdate.h,v 1.39 2005/11/05 11:00:04 frm Exp $</span>
00007 <span class="comment">// Copyright:   (c) 2005 Francesco Montorsi</span>
00008 <span class="comment">// Licence:     wxWidgets licence</span>
00010 <span class="comment"></span>
00011 
00012 <span class="preprocessor">#ifndef _WX_WEBUPDATE_H_</span>
00013 <span class="preprocessor"></span><span class="preprocessor">#define _WX_WEBUPDATE_H_</span>
00014 <span class="preprocessor"></span>
00015 <span class="comment">// wxWidgets headers</span>
00016 <span class="preprocessor">#include "<a class="code" href="webupdatedef_8h.html">wx/webupdatedef.h</a>"</span>
00017 <span class="preprocessor">#include "wx/xml/xml.h"</span>
00018 <span class="preprocessor">#include "wx/url.h"</span>
00019 <span class="preprocessor">#include "wx/log.h"</span>
00020 <span class="preprocessor">#include "wx/textfile.h"</span>
00021 
00022 
00023 <span class="comment">// defined later</span>
<a name="l00024"></a><a class="code" href="webupdate_8h.html#a2">00024</a> <span class="keyword">class </span><a class="code" href="webupdatedef_8h.html#a3">WXDLLIMPEXP_WEBUPDATE</a> <a class="code" href="classwxDownloadThread.html">wxDownloadThread</a>;
<a name="l00025"></a><a class="code" href="webupdate_8h.html#a3">00025</a> <span class="keyword">class </span><a class="code" href="webupdatedef_8h.html#a3">WXDLLIMPEXP_WEBUPDATE</a> <a class="code" href="classwxWebUpdateDownload.html">wxWebUpdateDownload</a>;
<a name="l00026"></a><a class="code" href="webupdate_8h.html#a4">00026</a> <span class="keyword">class </span><a class="code" href="webupdatedef_8h.html#a3">WXDLLIMPEXP_WEBUPDATE</a> <a class="code" href="classwxWebUpdatePackage.html">wxWebUpdatePackage</a>;
<a name="l00027"></a><a class="code" href="webupdate_8h.html#a5">00027</a> <span class="keyword">class </span><a class="code" href="webupdatedef_8h.html#a3">WXDLLIMPEXP_WEBUPDATE</a> <a class="code" href="classwxWebUpdateLocalPackage.html">wxWebUpdateLocalPackage</a>;
00028 
00029 <span class="preprocessor">#if wxUSE_HTTPENGINE</span>
00030 <span class="preprocessor"></span><span class="keyword">class </span>wxProxySettings;
00031 <span class="preprocessor">#endif</span>
00032 <span class="preprocessor"></span>
00035 <span class="keyword">extern</span> <a class="code" href="webupdatedef_8h.html#a4">WXDLLIMPEXP_DATA_WEBUPDATE</a>(<a class="code" href="classwxWebUpdateDownload.html">wxWebUpdateDownload</a>) <a class="code" href="webupdate_8cpp.html#a1">wxEmptyWebUpdateDownload</a>;
00036 extern <a class="code" href="webupdatedef_8h.html#a4">WXDLLIMPEXP_DATA_WEBUPDATE</a>(<a class="code" href="classwxWebUpdatePackage.html">wxWebUpdatePackage</a>) <a class="code" href="webupdate_8cpp.html#a2">wxEmptyWebUpdatePackage</a>;
00037 extern <a class="code" href="webupdatedef_8h.html#a4">WXDLLIMPEXP_DATA_WEBUPDATE</a>(<a class="code" href="classwxWebUpdateLocalPackage.html">wxWebUpdateLocalPackage</a>) <a class="code" href="webupdate_8cpp.html#a3">wxEmptyWebUpdateLocalPackage</a>;
00038 
00039 <a class="code" href="webupdatedef_8h.html#a3">WXDLLIMPEXP_WEBUPDATE</a> <span class="keywordtype">void</span> <a class="code" href="webupdate_8cpp.html#a8">wxUninitializeWebUpdate</a>();
00040 
<a name="l00042"></a><a class="code" href="webupdate_8h.html#a42">00042</a> enum <a class="code" href="webupdate_8h.html#a42">wxWebUpdatePort</a> {
00043     <a class="code" href="webupdate_8h.html#a42a7">wxWUP_INVALID</a> = -1,         
00044     <a class="code" href="webupdate_8h.html#a42a8">wxWUP_MSW</a>,                  
00045     <a class="code" href="webupdate_8h.html#a42a9">wxWUP_GTK</a>,                  
00046     <a class="code" href="webupdate_8h.html#a42a10">wxWUP_OS2</a>,                  
00047     <a class="code" href="webupdate_8h.html#a42a11">wxWUP_MAC</a>,                  
00048     <a class="code" href="webupdate_8h.html#a42a12">wxWUP_MOTIF</a>,                
00049     <a class="code" href="webupdate_8h.html#a42a13">wxWUP_X11</a>,                  
00050     <a class="code" href="webupdate_8h.html#a42a14">wxWUP_MGL</a>,                  
00051     <a class="code" href="webupdate_8h.html#a42a15">wxWUP_ANY</a>                   
00052 };
00053 
<a name="l00055"></a><a class="code" href="webupdate_8h.html#a43">00055</a> <span class="keyword">enum</span> <a class="code" href="webupdate_8h.html#a43">wxWebUpdateArch</a> {
00056     <a class="code" href="webupdate_8h.html#a43a16">wxWUA_INVALID</a> = -1,         
00057     <a class="code" href="webupdate_8h.html#a43a17">wxWUA_32</a>,                   
00058     <a class="code" href="webupdate_8h.html#a43a18">wxWUA_64</a>,                   
00059     <a class="code" href="webupdate_8h.html#a43a19">wxWUA_ANY</a>                   
00060 };
00061 
<a name="l00063"></a><a class="code" href="webupdate_8h.html#a44">00063</a> <span class="keyword">enum</span> <a class="code" href="webupdate_8h.html#a44">wxWebUpdateCheckFlag</a> {
00064 
00065     <a class="code" href="webupdate_8h.html#a44a20">wxWUCF_FAILED</a>,       
00066 
00067 
00068 
00069     <a class="code" href="webupdate_8h.html#a44a21">wxWUCF_UPDATED</a>,      
00070     <a class="code" href="webupdate_8h.html#a44a22">wxWUCF_OUTOFDATE</a>,    
00071     <a class="code" href="webupdate_8h.html#a44a23">wxWUCF_NOTINSTALLED</a>  
00072 };
00073 
00074 
<a name="l00077"></a><a class="code" href="webupdate_8h.html#a45">00077</a> <span class="keyword">enum</span> <a class="code" href="webupdate_8h.html#a45">wxWebUpdatePackageImportance</a> {
00078 
00079     <a class="code" href="webupdate_8h.html#a45a24">wxWUPI_HIGH</a>,                
00080     <a class="code" href="webupdate_8h.html#a45a25">wxWUPI_NORMAL</a>,              
00081     <a class="code" href="webupdate_8h.html#a45a26">wxWUPI_LOW</a>,                 
00082 };
00083 
00084 
<a name="l00091"></a><a class="code" href="webupdate_8h.html#a6">00091</a> <span class="keyword">typedef</span> wxString        <a class="code" href="webupdate_8h.html#a6">wxVersion</a>;
<a name="l00092"></a><a class="code" href="webupdate_8h.html#a0">00092</a> <span class="preprocessor">#define wxEmptyVersion  wxEmptyString</span>
00093 <span class="preprocessor"></span>
00094 
00095 
00096 <span class="comment">// the message sent to wxApp by wxWebUpdateAction::wxExecute</span>
00097 <a class="code" href="download_8h.html#a14">DECLARE_EXPORTED_EVENT_TYPE</a>(<a class="code" href="webupdatedef_8h.html#a3">WXDLLIMPEXP_WEBUPDATE</a>, wxEVT_COMMAND_EXECUTE, -1);
00098 
<a name="l00099"></a><a class="code" href="webupdate_8h.html#a1">00099</a> <span class="preprocessor">#define EVT_EXECUTE(id, func)                         \</span>
00100 <span class="preprocessor">    EVT_COMMAND(id, wxEVT_COMMAND_EXECUTE, func)</span>
00101 <span class="preprocessor"></span>
00102 
00103 
00104 
00105 
00106 <span class="comment">// --------------------------------</span>
00107 <span class="comment">// LOG FUNCTIONS USED BY WEBUPDATE</span>
00108 <span class="comment">// --------------------------------</span>
00109 
00110 <span class="keyword">enum</span>
00111 {
00112     <a class="code" href="webupdate_8h.html#a46a27">wxLOG_UsrMsg</a> = wxLOG_User,  <span class="comment">// messages shown to the user + saved in the log file</span>
00113     <a class="code" href="webupdate_8h.html#a46a28">wxLOG_AdvMsg</a>,               <span class="comment">// messages saved in the log file only</span>
00114     <a class="code" href="webupdate_8h.html#a46a29">wxLOG_NewSection</a>            <span class="comment">// a new phase in program flow</span>
00115 };
00116 
00117 <a class="code" href="webupdate_8h.html#a35">DECLARE_LOG_FUNCTION</a>(AdvMsg);
00118 <a class="code" href="webupdate_8h.html#a35">DECLARE_LOG_FUNCTION</a>(UsrMsg);
00119 <a class="code" href="webupdate_8h.html#a35">DECLARE_LOG_FUNCTION</a>(NewSection);
00120 
<a name="l00128"></a><a class="code" href="classwxWebUpdateLog.html">00128</a> <span class="keyword">class </span><a class="code" href="webupdatedef_8h.html#a3">WXDLLIMPEXP_WEBUPDATE</a> <a class="code" href="classwxWebUpdateLog.html">wxWebUpdateLog</a> : <span class="keyword">public</span> wxLogPassThrough
00129 {
00130     wxTextCtrl *m_pTextCtrl;
00131     wxTextFile m_txtFile;
00132 
00133 <span class="keyword">public</span>:
<a name="l00134"></a><a class="code" href="classwxWebUpdateLog.html#a0">00134</a>     <a class="code" href="classwxWebUpdateLog.html">wxWebUpdateLog</a>() { m_pTextCtrl=NULL; }
<a name="l00135"></a><a class="code" href="classwxWebUpdateLog.html#a1">00135</a>     <span class="keyword">virtual</span> ~<a class="code" href="classwxWebUpdateLog.html">wxWebUpdateLog</a>() { StopFileLog(); }
00136 
00137     <span class="keywordtype">void</span> WriteUsrMsgAlsoToTextCtrl(wxTextCtrl *);
00138     <span class="keywordtype">void</span> WriteAllMsgAlsoToFile(<span class="keyword">const</span> wxString &amp;filename);
00139     <span class="keywordtype">void</span> StopFileLog();
00140 
00141     <span class="keywordtype">void</span> DoLog(wxLogLevel, <span class="keyword">const</span> wxChar *, time_t);
00142     <span class="keywordtype">void</span> DoLogDecoratedString(wxLogLevel, <span class="keyword">const</span> wxChar *);
00143 
00144 <span class="keyword">private</span>:
00145     DECLARE_CLASS(<a class="code" href="classwxWebUpdateLog.html">wxWebUpdateLog</a>)
00146 };
00147 
00148 
00149 
00150 
00151 <span class="comment">// -----------------------------------------------------------------------------</span>
00152 <span class="comment">// CLASSES WHICH WORK WITH *LOCAL* FILES</span>
00153 <span class="comment">// -----------------------------------------------------------------------------</span>
00154 
<a name="l00160"></a><a class="code" href="classwxWebUpdateLocalPackage.html">00160</a> <span class="keyword">class </span><a class="code" href="webupdatedef_8h.html#a3">WXDLLIMPEXP_WEBUPDATE</a> wxWebUpdateLocalPackage : <span class="keyword">public</span> wxObject
00161 {
00162 <span class="keyword">protected</span>:
00163 
<a name="l00165"></a><a class="code" href="classwxWebUpdateLocalPackage.html#p0">00165</a>     wxString m_strName;
00166 
<a name="l00168"></a><a class="code" href="classwxWebUpdateLocalPackage.html#p1">00168</a>     <a class="code" href="webupdate_8h.html#a6">wxVersion</a> m_version;
00169 
00170 <span class="keyword">public</span>:
<a name="l00171"></a><a class="code" href="classwxWebUpdateLocalPackage.html#a0">00171</a>     <a class="code" href="webupdate_8h.html#a5">wxWebUpdateLocalPackage</a>(<span class="keyword">const</span> wxString &amp;name = wxEmptyString,
00172                             <span class="keyword">const</span> <a class="code" href="webupdate_8h.html#a6">wxVersion</a> &amp;ver = <a class="code" href="webupdate_8h.html#a0">wxEmptyVersion</a>)
00173         : m_strName(name), m_version(ver) {}
<a name="l00174"></a><a class="code" href="classwxWebUpdateLocalPackage.html#a1">00174</a>     <span class="keyword">virtual</span> ~wxWebUpdateLocalPackage() {}
00175 
00176 
<a name="l00177"></a><a class="code" href="classwxWebUpdateLocalPackage.html#a2">00177</a>     <span class="keywordtype">bool</span> IsOk()<span class="keyword"> const</span>
00178 <span class="keyword">        </span>{ <span class="keywordflow">return</span> !m_strName.IsEmpty() &amp;&amp; !m_version.IsEmpty(); }
00179 
<a name="l00180"></a><a class="code" href="classwxWebUpdateLocalPackage.html#a3">00180</a>     <a class="code" href="webupdate_8h.html#a6">wxVersion</a> GetVersion()<span class="keyword"> const</span>
00181 <span class="keyword">        </span>{ <span class="keywordflow">return</span> m_version; }
<a name="l00182"></a><a class="code" href="classwxWebUpdateLocalPackage.html#a4">00182</a>     wxString GetName()<span class="keyword"> const</span>
00183 <span class="keyword">        </span>{ <span class="keywordflow">return</span> m_strName; }
00184 
<a name="l00186"></a><a class="code" href="classwxWebUpdateLocalPackage.html#a5">00186</a>     <span class="keywordtype">void</span> SetVersion(<span class="keyword">const</span> <a class="code" href="webupdate_8h.html#a6">wxVersion</a> &amp;v)
00187         { m_version = v; }
00188 
00189 <span class="keyword">private</span>:
00190     DECLARE_CLASS(wxWebUpdateLocalPackage)
00191 };
00192 
00193 <span class="comment">// a container of wxWebUpdateLocalPackage used by wxWebUpdater</span>
00194 <a class="code" href="webupdate_8h.html#a38">WX_DECLARE_USER_EXPORTED_OBJARRAY</a>(wxWebUpdateLocalPackage, <a class="code" href="stdactions_8h.html#a4">wxWebUpdateLocalPackageArray</a>, <a class="code" href="webupdatedef_8h.html#a3">WXDLLIMPEXP_WEBUPDATE</a>);
00195 
<a name="l00201"></a><a class="code" href="classwxWebUpdateLocalXMLScript.html">00201</a> <span class="keyword">class </span><a class="code" href="webupdatedef_8h.html#a3">WXDLLIMPEXP_WEBUPDATE</a> wxWebUpdateLocalXMLScript : <span class="keyword">public</span> wxXmlDocument
00202 {
00205     wxString m_strRemoteURIOriginal;
00206 
00209     wxArrayString m_arrNames;
00210 
00213     wxArrayString m_arrValues;
00214 
00215 <span class="keyword">protected</span>:
00216 
<a name="l00220"></a><a class="code" href="classwxWebUpdateLocalXMLScript.html#p0">00220</a>     <a class="code" href="webupdate_8h.html#a6">wxVersion</a> m_strWebUpdateVersion;
00221 
<a name="l00223"></a><a class="code" href="classwxWebUpdateLocalXMLScript.html#p1">00223</a>     wxString m_strAppName;
00224 
<a name="l00226"></a><a class="code" href="classwxWebUpdateLocalXMLScript.html#p2">00226</a>     wxString m_strXRC;
00227 
<a name="l00230"></a><a class="code" href="classwxWebUpdateLocalXMLScript.html#p3">00230</a>     wxString m_strXRCRes;
00231 
<a name="l00233"></a><a class="code" href="classwxWebUpdateLocalXMLScript.html#p4">00233</a>     wxString m_strRemoteURI;
00234 
<a name="l00236"></a><a class="code" href="classwxWebUpdateLocalXMLScript.html#p5">00236</a>     wxString m_strAppFile;
00237 
<a name="l00240"></a><a class="code" href="classwxWebUpdateLocalXMLScript.html#p6">00240</a>     wxString m_strLocalURI;
00241 
<a name="l00243"></a><a class="code" href="classwxWebUpdateLocalXMLScript.html#p7">00243</a>     <span class="keywordtype">bool</span> m_bSaveLog;
00244 
<a name="l00246"></a><a class="code" href="classwxWebUpdateLocalXMLScript.html#p8">00246</a>     <span class="keywordtype">bool</span> m_bRestart;
00247 
00248 <span class="keyword">protected</span>:
00249 
00252     wxWebUpdateLocalPackage *GetPackage(<span class="keyword">const</span> wxXmlNode *package) <span class="keyword">const</span>;
00253 
00255     wxString GetNodeContent(<span class="keyword">const</span> wxXmlNode *node) <span class="keyword">const</span>;
00256 
00258     wxXmlNode *BuildHeader() <span class="keyword">const</span>;
00259 
00261     <span class="keywordtype">void</span> SetRemoteScriptURI(<span class="keyword">const</span> wxString &amp;uri);
00262 
00263 <span class="keyword">public</span>:
00264 
00265     wxWebUpdateLocalXMLScript(<span class="keyword">const</span> wxString &amp;localURI = wxEmptyString);
<a name="l00266"></a><a class="code" href="classwxWebUpdateLocalXMLScript.html#a1">00266</a>     <span class="keyword">virtual</span> ~wxWebUpdateLocalXMLScript() {}
00267 
00268 <span class="keyword">public</span>:         <span class="comment">// main functions</span>
00269 
00271     <span class="keywordtype">bool</span> IsOk() <span class="keyword">const</span>;
00272 
00276     <span class="keywordtype">bool</span> IsComplete() <span class="keyword">const</span>;
00277 
00283     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> Load(<span class="keyword">const</span> wxString &amp;uri);
00284 
00288     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> Save() <span class="keyword">const</span>;
00289 
00290 
00291 <span class="keyword">public</span>:         <span class="comment">// getters</span>
00292 
00296     <span class="keyword">virtual</span> wxWebUpdateLocalPackage *GetPackage(<span class="keyword">const</span> wxString &amp;packagename) <span class="keyword">const</span>;
00297 
00299     <span class="keyword">virtual</span> <a class="code" href="stdactions_8h.html#a4">wxWebUpdateLocalPackageArray</a> GetAllPackages() <span class="keyword">const</span>;
00300 
<a name="l00302"></a><a class="code" href="classwxWebUpdateLocalXMLScript.html#a8">00302</a>     wxString GetAppName()<span class="keyword"> const</span>
00303 <span class="keyword">        </span>{ <span class="keywordflow">return</span> m_strAppName; }
00304 
<a name="l00306"></a><a class="code" href="classwxWebUpdateLocalXMLScript.html#a9">00306</a>     wxString GetAppFile()<span class="keyword"> const</span>
00307 <span class="keyword">        </span>{ <span class="keywordflow">return</span> m_strAppFile; }
00308 
<a name="l00310"></a><a class="code" href="classwxWebUpdateLocalXMLScript.html#a10">00310</a>     wxString GetXRC()<span class="keyword"> const</span>
00311 <span class="keyword">        </span>{ <span class="keywordflow">return</span> m_strXRC; }
00312 
<a name="l00314"></a><a class="code" href="classwxWebUpdateLocalXMLScript.html#a11">00314</a>     wxString GetXRCResName()<span class="keyword"> const</span>
00315 <span class="keyword">        </span>{ <span class="keywordflow">return</span> m_strXRCRes; }
00316 
<a name="l00318"></a><a class="code" href="classwxWebUpdateLocalXMLScript.html#a12">00318</a>     wxString GetRemoteScriptURI()<span class="keyword"> const</span>
00319 <span class="keyword">        </span>{ <span class="keywordflow">return</span> m_strRemoteURI; }
00320 
<a name="l00322"></a><a class="code" href="classwxWebUpdateLocalXMLScript.html#a13">00322</a>     wxString GetLocalScriptURI()<span class="keyword"> const</span>
00323 <span class="keyword">        </span>{ <span class="keywordflow">return</span> m_strLocalURI; }
00324 
<a name="l00326"></a><a class="code" href="classwxWebUpdateLocalXMLScript.html#a14">00326</a>     <span class="keywordtype">bool</span> IsAppToRestart()<span class="keyword"> const</span>
00327 <span class="keyword">        </span>{ <span class="keywordflow">return</span> m_bRestart; }
00328 
<a name="l00330"></a><a class="code" href="classwxWebUpdateLocalXMLScript.html#a15">00330</a>     <span class="keywordtype">bool</span> IsLogToSave()<span class="keyword"> const</span>
00331 <span class="keyword">        </span>{ <span class="keywordflow">return</span> m_bSaveLog; }
00332 
00333 <span class="keyword">public</span>:         <span class="comment">// setters</span>
00334 
00337     <span class="keywordtype">void</span> SetPackageArray(<span class="keyword">const</span> <a class="code" href="stdactions_8h.html#a4">wxWebUpdateLocalPackageArray</a> &amp;arr);
00338 
<a name="l00339"></a><a class="code" href="classwxWebUpdateLocalXMLScript.html#a17">00339</a>     <span class="keywordtype">void</span> OverrideXRC(<span class="keyword">const</span> wxString &amp;xrc)
00340         { m_strXRC = xrc; }
<a name="l00341"></a><a class="code" href="classwxWebUpdateLocalXMLScript.html#a18">00341</a>     <span class="keywordtype">void</span> OverrideXRCResName(<span class="keyword">const</span> wxString &amp;xrcres)
00342         { m_strXRCRes = xrcres; }
<a name="l00343"></a><a class="code" href="classwxWebUpdateLocalXMLScript.html#a19">00343</a>     <span class="keywordtype">void</span> OverrideRestartFlag(<span class="keywordtype">bool</span> val)
00344         { m_bRestart = val; }
<a name="l00345"></a><a class="code" href="classwxWebUpdateLocalXMLScript.html#a20">00345</a>     <span class="keywordtype">void</span> OverrideSaveLogFlag(<span class="keywordtype">bool</span> val)
00346         { m_bSaveLog = val; }
<a name="l00347"></a><a class="code" href="classwxWebUpdateLocalXMLScript.html#a21">00347</a>     <span class="keywordtype">void</span> OverrideRemoteScriptURI(<span class="keyword">const</span> wxString &amp;remote)
00348         { SetRemoteScriptURI(remote); }
00349 
00350 <span class="keyword">private</span>:
00351     DECLARE_CLASS(wxWebUpdateLocalXMLScript)
00352 };
00353 
00354 
00355 
00356 
00357 
00358 
00359 <span class="comment">// -----------------------------------------------------------------------------</span>
00360 <span class="comment">// CLASSES WHICH WORK WITH *REMOTE* FILES</span>
00361 <span class="comment">// -----------------------------------------------------------------------------</span>
00362 
<a name="l00367"></a><a class="code" href="classwxWebUpdateAction.html">00367</a> <span class="keyword">class </span><a class="code" href="webupdatedef_8h.html#a3">WXDLLIMPEXP_WEBUPDATE</a> wxWebUpdateAction : <span class="keyword">public</span> wxObject
00368 {
00369 <span class="keyword">public</span>:         <span class="comment">// see the hack in wxApp::OnExecute</span>
00370 
00373     <span class="keyword">static</span> <span class="keywordtype">int</span> m_nExecResult;
00374 
00375 <span class="keyword">protected</span>:
00376 
<a name="l00378"></a><a class="code" href="classwxWebUpdateAction.html#p0">00378</a>     wxString m_strName;
00379 
<a name="l00381"></a><a class="code" href="classwxWebUpdateAction.html#p1">00381</a>     wxArrayString m_arrPropName;
00382 
<a name="l00384"></a><a class="code" href="classwxWebUpdateAction.html#p2">00384</a>     wxArrayString m_arrPropValue;
00385 
00386 <span class="keyword">public</span>:
<a name="l00387"></a><a class="code" href="classwxWebUpdateAction.html#a0">00387</a>     wxWebUpdateAction(<span class="keyword">const</span> wxString &amp;name = wxEmptyString)
00388         : m_strName(name) { }
00389 
<a name="l00390"></a><a class="code" href="classwxWebUpdateAction.html#a1">00390</a>     <span class="keyword">virtual</span> ~wxWebUpdateAction() {}
00391 
00392 <span class="keyword">public</span>:         <span class="comment">// utilities</span>
00393 
00399     <span class="keyword">virtual</span> <span class="keywordtype">long</span> wxExecute(<span class="keyword">const</span> wxString &amp;command, <span class="keywordtype">int</span> flags = wxEXEC_ASYNC) <span class="keyword">const</span>;
00400 
00401 <span class="keyword">public</span>:         <span class="comment">// miscellaneous</span>
00402 
<a name="l00404"></a><a class="code" href="classwxWebUpdateAction.html#a3">00404</a>     <span class="keywordtype">bool</span> IsOk()<span class="keyword"> const</span>
00405 <span class="keyword">    </span>{ <span class="keywordflow">return</span> !m_strName.IsEmpty() &amp;&amp;
00406             m_arrPropName.GetCount() == m_arrPropValue.GetCount(); }
00407 
<a name="l00410"></a><a class="code" href="classwxWebUpdateAction.html#a4">00410</a>     wxString GetPropValue(<span class="keyword">const</span> wxString &amp;propname)<span class="keyword"> const</span>
00411 <span class="keyword">        </span>{ <span class="keywordtype">int</span> n=m_arrPropName.Index(propname); <span class="keywordflow">if</span> (n!=wxNOT_FOUND) <span class="keywordflow">return</span> m_arrPropValue.Item(n); <span class="keywordflow">return</span> wxEmptyString; }
00412 
00421     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> SetProperties(<span class="keyword">const</span> wxArrayString &amp;propnames,
00422                                 <span class="keyword">const</span> wxArrayString &amp;propvalues) = 0;
00423 
00432     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> Run() <span class="keyword">const </span>= 0;
00433 
00435     <span class="keyword">virtual</span> wxWebUpdateAction *Clone() <span class="keyword">const </span>= 0;
00436 
00437 <span class="keyword">public</span>:     <span class="comment">// getters</span>
00438 
<a name="l00439"></a><a class="code" href="classwxWebUpdateAction.html#a8">00439</a>     wxString GetName()<span class="keyword"> const</span>
00440 <span class="keyword">    </span>{ <span class="keywordflow">return</span> m_strName; }
00441 
00442 <span class="keyword">private</span>:
00443     DECLARE_CLASS(wxWebUpdateAction)
00444 };
00445 
00446 <span class="comment">// a container of wxWebUpdateAction used by wxWebUpdateDownload</span>
00447 <a class="code" href="webupdate_8h.html#a38">WX_DECLARE_USER_EXPORTED_OBJARRAY</a>(wxWebUpdateAction*, wxWebUpdateActionArray, <a class="code" href="webupdatedef_8h.html#a3">WXDLLIMPEXP_WEBUPDATE</a>);
00448 
00449 
<a name="l00451"></a><a class="code" href="classwxWebUpdatePlatform.html">00451</a> <span class="keyword">class </span><a class="code" href="webupdatedef_8h.html#a3">WXDLLIMPEXP_WEBUPDATE</a> wxWebUpdatePlatform : <span class="keyword">public</span> wxObject
00452 {
00453 <span class="keyword">protected</span>:
00454 
<a name="l00456"></a><a class="code" href="classwxWebUpdatePlatform.html#p0">00456</a>     <a class="code" href="webupdate_8h.html#a42">wxWebUpdatePort</a> m_name;
00457 
<a name="l00459"></a><a class="code" href="classwxWebUpdatePlatform.html#p1">00459</a>     <a class="code" href="webupdate_8h.html#a43">wxWebUpdateArch</a> m_arch;
00460 
<a name="l00462"></a><a class="code" href="classwxWebUpdatePlatform.html#p2">00462</a>     wxString m_strID;
00463 
00464 <span class="keyword">protected</span>:      <span class="comment">// string -&gt; enum conversions</span>
00465 
00466     <span class="keyword">static</span> <a class="code" href="webupdate_8h.html#a42">wxWebUpdatePort</a> GetPort(<span class="keyword">const</span> wxString &amp;portname);
00467     <span class="keyword">static</span> <a class="code" href="webupdate_8h.html#a43">wxWebUpdateArch</a> GetArch(<span class="keyword">const</span> wxString &amp;arch);
00468 
00469 <span class="keyword">protected</span>:      <span class="comment">// enum -&gt; string conversions</span>
00470     
00471     <span class="keyword">static</span> wxString GetPortString(<a class="code" href="webupdate_8h.html#a42">wxWebUpdatePort</a>);
00472     <span class="keyword">static</span> wxString GetArchString(<a class="code" href="webupdate_8h.html#a43">wxWebUpdateArch</a>);
00473 
00474 <span class="keyword">public</span>:
00475 
00476     <span class="comment">// constructor using enums</span>
<a name="l00477"></a><a class="code" href="classwxWebUpdatePlatform.html#a0">00477</a>     wxWebUpdatePlatform(<span class="keyword">const</span> <a class="code" href="webupdate_8h.html#a42">wxWebUpdatePort</a> &amp;port = <a class="code" href="webupdate_8h.html#a42a15">wxWUP_ANY</a>,
00478                         <span class="keyword">const</span> <a class="code" href="webupdate_8h.html#a43">wxWebUpdateArch</a> &amp;arch = <a class="code" href="webupdate_8h.html#a43a17">wxWUA_32</a>, 
00479                         <span class="keyword">const</span> wxString &amp;<span class="keywordtype">id</span> = wxT(<span class="stringliteral">"*"</span>))
00480                         : m_name(port), m_arch(arch), m_strID(id) {}
00481 
00482     <span class="comment">// constructor with wxStrings</span>
<a name="l00483"></a><a class="code" href="classwxWebUpdatePlatform.html#a1">00483</a>     wxWebUpdatePlatform(<span class="keyword">const</span> wxString &amp;portname,
00484                         <span class="keyword">const</span> wxString &amp;arch = wxT(<span class="stringliteral">"32"</span>), 
00485                         <span class="keyword">const</span> wxString &amp;<span class="keywordtype">id</span> = wxT(<span class="stringliteral">"*"</span>))
00486                         : m_strID(id) 
00487         { m_name = GetPort(portname); m_arch = GetArch(arch); }
00488 
<a name="l00489"></a><a class="code" href="classwxWebUpdatePlatform.html#a2">00489</a>     <span class="keyword">virtual</span> ~wxWebUpdatePlatform() {}
00490 
00491 
<a name="l00493"></a><a class="code" href="classwxWebUpdatePlatform.html#a3">00493</a>     <span class="keywordtype">bool</span> IsOk()<span class="keyword"> const</span>
00494 <span class="keyword">        </span>{ <span class="keywordflow">return</span> (m_name != <a class="code" href="webupdate_8h.html#a42a7">wxWUP_INVALID</a> &amp;&amp; m_arch != <a class="code" href="webupdate_8h.html#a43a16">wxWUA_INVALID</a> &amp;&amp; !m_strID.IsEmpty()); }
00495 
00497     <span class="keywordtype">bool</span> Matches(<span class="keyword">const</span> wxWebUpdatePlatform &amp;) <span class="keyword">const</span>;
00498 
00499 
00500 <span class="keyword">public</span>:         <span class="comment">// getters &amp; setters</span>
00501 
<a name="l00502"></a><a class="code" href="classwxWebUpdatePlatform.html#a5">00502</a>     <a class="code" href="webupdate_8h.html#a43">wxWebUpdateArch</a> GetArchitecture()<span class="keyword"> const</span>
00503 <span class="keyword">        </span>{ <span class="keywordflow">return</span> m_arch; }
<a name="l00504"></a><a class="code" href="classwxWebUpdatePlatform.html#a6">00504</a>     wxString GetID()<span class="keyword"> const</span>
00505 <span class="keyword">        </span>{ <span class="keywordflow">return</span> m_strID; }
<a name="l00506"></a><a class="code" href="classwxWebUpdatePlatform.html#a7">00506</a>     <a class="code" href="webupdate_8h.html#a42">wxWebUpdatePort</a> GetPort()<span class="keyword"> const</span>
00507 <span class="keyword">        </span>{ <span class="keywordflow">return</span> m_name; }
<a name="l00508"></a><a class="code" href="classwxWebUpdatePlatform.html#a8">00508</a>     <span class="keywordtype">void</span> SetPort(<a class="code" href="webupdate_8h.html#a42">wxWebUpdatePort</a> port)
00509         { m_name = port; }
<a name="l00510"></a><a class="code" href="classwxWebUpdatePlatform.html#a9">00510</a>     <span class="keywordtype">void</span> SetArch(<a class="code" href="webupdate_8h.html#a43">wxWebUpdateArch</a> arch)
00511         { m_arch = arch; }
<a name="l00512"></a><a class="code" href="classwxWebUpdatePlatform.html#a10">00512</a>     <span class="keywordtype">void</span> SetID(<span class="keyword">const</span> wxString &amp;<span class="keywordtype">id</span>)
00513         { m_strID = id; }
00514 
00516     wxString GetAsString() <span class="keyword">const</span>;
00517 
00518 <span class="keyword">public</span>:         <span class="comment">// operators</span>
00519 
<a name="l00520"></a><a class="code" href="classwxWebUpdatePlatform.html#a12">00520</a>     <span class="keywordtype">bool</span> operator ==(<span class="keyword">const</span> wxWebUpdatePlatform &amp;a)<span class="keyword"> const</span>
00521 <span class="keyword">        </span>{ <span class="keywordflow">return</span> (m_name == a.<a class="code" href="classwxWebUpdatePlatform.html#p0">m_name</a> &amp;&amp; m_arch == a.<a class="code" href="classwxWebUpdatePlatform.html#p1">m_arch</a> &amp;&amp; m_strID == a.<a class="code" href="classwxWebUpdatePlatform.html#p2">m_strID</a>); }
<a name="l00522"></a><a class="code" href="classwxWebUpdatePlatform.html#a13">00522</a>     <span class="keywordtype">bool</span> operator !=(<span class="keyword">const</span> wxWebUpdatePlatform &amp;a)<span class="keyword"> const</span>
00523 <span class="keyword">        </span>{ <span class="keywordflow">return</span> !(*<span class="keyword">this</span> == a); }
00524 
00525 
00526 <span class="keyword">public</span>:         <span class="comment">// static platform utilities</span>
00527 
00530     <span class="keyword">static</span> wxWebUpdatePlatform GetThisPlatform();
00531 };
00532 
<a name="l00534"></a><a class="code" href="classwxWebUpdateDownload.html">00534</a> <span class="keyword">class </span><a class="code" href="webupdatedef_8h.html#a3">WXDLLIMPEXP_WEBUPDATE</a> wxWebUpdateDownload : <span class="keyword">public</span> wxObject
00535 {
00536 <span class="keyword">protected</span>:
00537 
<a name="l00539"></a><a class="code" href="classwxWebUpdateDownload.html#p0">00539</a>     wxWebUpdatePlatform m_platform;
00540 
<a name="l00544"></a><a class="code" href="classwxWebUpdateDownload.html#p1">00544</a>     wxString m_strMD5;
00545 
<a name="l00553"></a><a class="code" href="classwxWebUpdateDownload.html#p2">00553</a>     wxString m_urlDownload;
00554 
<a name="l00570"></a><a class="code" href="classwxWebUpdateDownload.html#p3">00570</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> m_size;
00571 
<a name="l00576"></a><a class="code" href="classwxWebUpdateDownload.html#p4">00576</a>     wxWebUpdateActionArray m_arrActions;
00577 
00578 <span class="keyword">public</span>:
<a name="l00579"></a><a class="code" href="classwxWebUpdateDownload.html#a0">00579</a>     <a class="code" href="stdactions_8h.html#a2">wxWebUpdateDownload</a>(<span class="keyword">const</span> wxString &amp;url,
00580                         <span class="keyword">const</span> wxWebUpdatePlatform &amp;plat = <a class="code" href="webupdate_8h.html#a42a7">wxWUP_INVALID</a>,
00581                         <span class="keyword">const</span> wxString &amp;md5 = wxEmptyString,                        
00582                         <span class="keyword">const</span> wxWebUpdateActionArray *actions = NULL)
00583     : m_platform(<a class="code" href="webupdate_8h.html#a42a7">wxWUP_INVALID</a>), m_strMD5(md5), m_urlDownload(url)
00584         { SetPlatform(plat); m_size=1; <span class="keywordflow">if</span> (actions) m_arrActions = *actions; }
00585 
00586     <span class="keyword">virtual</span> ~wxWebUpdateDownload();
00587 
00588 <span class="keyword">public</span>:         <span class="comment">// handle in the right way the issue of the m_arrActions array</span>
00589             <span class="comment">// which contains pointers to classes which needs to be copied</span>
00590             <span class="comment">// in order to avoid double-destruction (and thus invalid memory</span>
00591             <span class="comment">// accesses) of the same pointers !</span>
00592 
<a name="l00593"></a><a class="code" href="classwxWebUpdateDownload.html#a2">00593</a>     <a class="code" href="stdactions_8h.html#a2">wxWebUpdateDownload</a>(<span class="keyword">const</span> wxWebUpdateDownload &amp;tocopy)
00594         : wxObject()            <span class="comment">// avoid warnings with GCC</span>
00595         { Copy(tocopy); }
00596 
00599     <span class="keywordtype">void</span> Copy(<span class="keyword">const</span> wxWebUpdateDownload &amp;tocopy);
00600 
<a name="l00602"></a><a class="code" href="classwxWebUpdateDownload.html#a4">00602</a>     wxWebUpdateDownload &amp;operator =(<span class="keyword">const</span> wxWebUpdateDownload &amp;tocopy)
00603         { Copy(tocopy); <span class="keywordflow">return</span> *<span class="keyword">this</span>; }
00604 
<a name="l00605"></a><a class="code" href="classwxWebUpdateDownload.html#a5">00605</a>     <span class="keywordtype">bool</span> operator ==(<span class="keyword">const</span> wxWebUpdateDownload &amp;a)<span class="keyword"> const</span>
00606 <span class="keyword">        </span>{ <span class="keywordflow">return</span> (m_platform == a.<a class="code" href="classwxWebUpdateDownload.html#p0">m_platform</a> &amp;&amp; m_strMD5 == a.<a class="code" href="classwxWebUpdateDownload.html#p1">m_strMD5</a> &amp;&amp; 
00607                     m_urlDownload == a.<a class="code" href="classwxWebUpdateDownload.html#p2">m_urlDownload</a> &amp;&amp; m_size == a.<a class="code" href="classwxWebUpdateDownload.html#p3">m_size</a>); }
<a name="l00608"></a><a class="code" href="classwxWebUpdateDownload.html#a6">00608</a>     <span class="keywordtype">bool</span> operator !=(<span class="keyword">const</span> wxWebUpdateDownload &amp;a)<span class="keyword"> const</span>
00609 <span class="keyword">        </span>{ <span class="keywordflow">return</span> !(*<span class="keyword">this</span> == a); }
00610 
00611 <span class="keyword">public</span>:         <span class="comment">// miscellaneous</span>
00612 
<a name="l00614"></a><a class="code" href="classwxWebUpdateDownload.html#a7">00614</a>     <span class="keywordtype">bool</span> IsOk()<span class="keyword"> const</span>
00615 <span class="keyword">        </span>{ <span class="keywordflow">return</span> wxURL(m_urlDownload).GetError() == wxURL_NOERR &amp;&amp;
00616                     (m_strMD5.IsEmpty() || m_strMD5.Len() == 32) &amp;&amp; 
00617                     m_platform != <a class="code" href="webupdate_8h.html#a42a7">wxWUP_INVALID</a>; }
00618 
<a name="l00621"></a><a class="code" href="classwxWebUpdateDownload.html#a8">00621</a>     <span class="keywordtype">bool</span> IsOkForThisPlatform()<span class="keyword"> const</span>
00622 <span class="keyword">        </span>{ <span class="keywordflow">return</span> IsOk() &amp;&amp; m_platform.Matches(<a class="code" href="classwxWebUpdatePlatform.html#e0">wxWebUpdatePlatform::GetThisPlatform</a>()); }
00623 
<a name="l00625"></a><a class="code" href="classwxWebUpdateDownload.html#a9">00625</a>     <span class="keywordtype">bool</span> IsDownloadSizeCached()<span class="keyword"> const</span>
00626 <span class="keyword">        </span>{ <span class="keywordflow">return</span> m_size != 1; }
00627 
<a name="l00629"></a><a class="code" href="classwxWebUpdateDownload.html#a10">00629</a>     <span class="keywordtype">void</span> SetDownloadSize(<span class="keywordtype">int</span> n)
00630         { m_size=n; }
00631 
00638     <span class="keyword">virtual</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> GetDownloadSize(<span class="keywordtype">bool</span> forceRecalc = FALSE);
00639 
00642     <span class="keyword">virtual</span> wxString GetFileName() <span class="keyword">const</span>;
00643 
00644 <span class="keyword">public</span>:         <span class="comment">// main functions</span>
00645 
00652     <span class="keyword">virtual</span> <a class="code" href="classwxDownloadThread.html">wxDownloadThread</a> *DownloadAsynch(<span class="keyword">const</span> wxString &amp;path,
00653                                 wxEvtHandler *handler
00654 #<span class="keywordflow">if</span> <a class="code" href="webupdatedef_8h.html#a2">wxUSE_HTTPENGINE</a>
00655                                 , <span class="keyword">const</span> wxProxySettings &amp;proxy
00656 #endif
00657                                 );
00658 
00661     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> DownloadSynch(<span class="keyword">const</span> wxString &amp;path
00662 #<span class="keywordflow">if</span> <a class="code" href="webupdatedef_8h.html#a2">wxUSE_HTTPENGINE</a>
00663                                 , <span class="keyword">const</span> wxProxySettings &amp;proxy
00664 #endif
00665                                 );
00666 
00669     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> Install() <span class="keyword">const</span>;
00670 
00671 <span class="keyword">public</span>:     <span class="comment">// setters</span>
00672 
<a name="l00675"></a><a class="code" href="classwxWebUpdateDownload.html#a16">00675</a>     <span class="keywordtype">bool</span> SetURL(<span class="keyword">const</span> wxString &amp;url) {
00676         wxURL u(url); <span class="keywordflow">if</span> (u.GetError() != wxURL_NOERR) <span class="keywordflow">return</span> FALSE;
00677         m_urlDownload=url; <span class="keywordflow">return</span> TRUE;
00678     }
00679 
<a name="l00681"></a><a class="code" href="classwxWebUpdateDownload.html#a17">00681</a>     <span class="keywordtype">bool</span> SetPlatform(<span class="keyword">const</span> wxWebUpdatePlatform &amp;plat) {
00682         m_platform = plat;
00683         <span class="keywordflow">if</span> (m_platform == <a class="code" href="webupdate_8h.html#a42a7">wxWUP_INVALID</a>)
00684             <span class="keywordflow">return</span> FALSE;
00685         <span class="keywordflow">return</span> TRUE;
00686     }
00687 
00688 <span class="keyword">public</span>:     <span class="comment">// getters</span>
00689 
<a name="l00690"></a><a class="code" href="classwxWebUpdateDownload.html#a18">00690</a>     wxURL GetDownloadURL()<span class="keyword"> const</span>
00691 <span class="keyword">        </span>{ <span class="keywordflow">return</span> m_urlDownload; }
00692 
<a name="l00693"></a><a class="code" href="classwxWebUpdateDownload.html#a19">00693</a>     wxString GetDownloadString()<span class="keyword"> const</span>
00694 <span class="keyword">        </span>{ <span class="keywordflow">return</span> m_urlDownload; }
00695 
<a name="l00696"></a><a class="code" href="classwxWebUpdateDownload.html#a20">00696</a>     wxWebUpdatePlatform GetPlatform()<span class="keyword"> const</span>
00697 <span class="keyword">        </span>{ <span class="keywordflow">return</span> m_platform; }
00698 
<a name="l00699"></a><a class="code" href="classwxWebUpdateDownload.html#a21">00699</a>     wxString GetMD5Checksum()<span class="keyword"> const</span>
00700 <span class="keyword">        </span>{ <span class="keywordflow">return</span> m_strMD5; }
00701 
00702 <span class="keyword">private</span>:
00703     DECLARE_CLASS(wxWebUpdateDownload)
00704 };
00705 
00706 
00707 <span class="comment">// a container of wxWebUpdateDownload used by wxWebUpdatePackage</span>
00708 <a class="code" href="webupdate_8h.html#a38">WX_DECLARE_USER_EXPORTED_OBJARRAY</a>(wxWebUpdateDownload, wxWebUpdateDownloadArray, <a class="code" href="webupdatedef_8h.html#a3">WXDLLIMPEXP_WEBUPDATE</a>);
00709 
00710 
<a name="l00712"></a><a class="code" href="classwxWebUpdatePackage.html">00712</a> <span class="keyword">class </span><a class="code" href="webupdatedef_8h.html#a3">WXDLLIMPEXP_WEBUPDATE</a> wxWebUpdatePackage : <span class="keyword">public</span> wxObject
00713 {
<a name="l00714"></a><a class="code" href="classwxWebUpdatePackage.html#n0">00714</a>     <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classwxWebUpdateXMLScript.html">wxWebUpdateXMLScript</a>;
00715 
00716 <span class="keyword">protected</span>:              <span class="comment">// member variables</span>
00717 
<a name="l00719"></a><a class="code" href="classwxWebUpdatePackage.html#p0">00719</a>     wxString m_strID;
00720 
<a name="l00725"></a><a class="code" href="classwxWebUpdatePackage.html#p1">00725</a>     <a class="code" href="webupdate_8h.html#a6">wxVersion</a> m_strLatestVersion;
00726 
<a name="l00728"></a><a class="code" href="classwxWebUpdatePackage.html#p2">00728</a>     wxString m_strDescription;
00729 
<a name="l00731"></a><a class="code" href="classwxWebUpdatePackage.html#p3">00731</a>     <a class="code" href="webupdate_8h.html#a45">wxWebUpdatePackageImportance</a> m_importance;
00732 
<a name="l00736"></a><a class="code" href="classwxWebUpdatePackage.html#p4">00736</a>     wxWebUpdateDownloadArray m_arrWebUpdates;
00737 
<a name="l00740"></a><a class="code" href="classwxWebUpdatePackage.html#p5">00740</a>     wxString m_strPrerequisites;
00741 
00742 <span class="keyword">public</span>:         <span class="comment">// utilities</span>
00743 
00745     <span class="keyword">static</span> <span class="keywordtype">bool</span> ExtractVersionNumbers(<span class="keyword">const</span> <a class="code" href="webupdate_8h.html#a6">wxVersion</a> &amp;str, <span class="keywordtype">int</span> *maj, <span class="keywordtype">int</span> *min, <span class="keywordtype">int</span> *rel);
00746 
00751     <span class="keyword">static</span> <span class="keywordtype">int</span> StdVersionCheck(<span class="keywordtype">int</span> maj1, <span class="keywordtype">int</span> min1, <span class="keywordtype">int</span> rel1,
00752                             <span class="keywordtype">int</span> maj2, <span class="keywordtype">int</span> min2, <span class="keywordtype">int</span> rel2);
00753 
00754 <span class="keyword">public</span>:
<a name="l00755"></a><a class="code" href="classwxWebUpdatePackage.html#a0">00755</a>     <a class="code" href="stdactions_8h.html#a3">wxWebUpdatePackage</a>(<span class="keyword">const</span> wxString &amp;<span class="keywordtype">id</span> = wxEmptyString) : m_strID(id) {}
<a name="l00756"></a><a class="code" href="classwxWebUpdatePackage.html#a1">00756</a>     <span class="keyword">virtual</span> ~wxWebUpdatePackage() { m_arrWebUpdates.Clear(); }
00757 
00758 <span class="keyword">public</span>:         <span class="comment">// package utilities</span>
00759 
<a name="l00761"></a><a class="code" href="classwxWebUpdatePackage.html#a2">00761</a>     <span class="keywordtype">bool</span> <a class="code" href="classwxWebUpdateXMLScript.html#a2">IsOk</a>()<span class="keyword"> const</span>
00762 <span class="keyword">        </span>{ <span class="keywordflow">return</span> !m_strID.IsEmpty() &amp;&amp; !m_strLatestVersion.IsEmpty() &amp;&amp;
00763                 m_arrWebUpdates.GetCount() &gt; 0; }
00764 
<a name="l00766"></a><a class="code" href="classwxWebUpdatePackage.html#a3">00766</a>     <span class="keyword">virtual</span> <span class="keywordtype">void</span> AddDownload(<span class="keyword">const</span> wxWebUpdateDownload &amp;toadd)
00767         { m_arrWebUpdates.Add(toadd); }
00768 
00773     <span class="keyword">virtual</span> wxWebUpdateDownload &amp;<a class="code" href="classwxWebUpdateXMLScript.html#b2">GetDownload</a>(
00774                 wxWebUpdatePlatform plat = <a class="code" href="webupdate_8h.html#a42a7">wxWUP_INVALID</a>) <span class="keyword">const</span>;
00775 
00777     <span class="keyword">virtual</span> <span class="keywordtype">void</span> CacheDownloadSizes();
00778 
00779 <span class="keyword">public</span>:         <span class="comment">// version check</span>
00780 
00789     <span class="keyword">virtual</span> <a class="code" href="webupdate_8h.html#a44">wxWebUpdateCheckFlag</a> Check(<span class="keyword">const</span> <a class="code" href="webupdate_8h.html#a6">wxVersion</a> &amp;localversion) <span class="keyword">const</span>;
00790     <span class="keyword">virtual</span> <a class="code" href="webupdate_8h.html#a44">wxWebUpdateCheckFlag</a> Check(<span class="keywordtype">int</span> maj, <span class="keywordtype">int</span> min, <span class="keywordtype">int</span> rel) <span class="keyword">const</span>;
00791 
00792 <span class="keyword">public</span>:         <span class="comment">// getters</span>
00793 
<a name="l00795"></a><a class="code" href="classwxWebUpdatePackage.html#a8">00795</a>     wxString GetName()<span class="keyword"> const</span>
00796 <span class="keyword">        </span>{ <span class="keywordflow">return</span> m_strID; }
00797 
<a name="l00799"></a><a class="code" href="classwxWebUpdatePackage.html#a9">00799</a>     wxString GetLatestVersion()<span class="keyword"> const</span>
00800 <span class="keyword">        </span>{ <span class="keywordflow">return</span> m_strLatestVersion; }
00801 
<a name="l00803"></a><a class="code" href="classwxWebUpdatePackage.html#a10">00803</a>     wxString GetDescription()<span class="keyword"> const</span>
00804 <span class="keyword">        </span>{ <span class="keywordflow">return</span> m_strDescription; }
00805 
<a name="l00807"></a><a class="code" href="classwxWebUpdatePackage.html#a11">00807</a>     <a class="code" href="webupdate_8h.html#a45">wxWebUpdatePackageImportance</a> GetImportance()<span class="keyword"> const</span>
00808 <span class="keyword">        </span>{ <span class="keywordflow">return</span> m_importance; }
00809 
<a name="l00811"></a><a class="code" href="classwxWebUpdatePackage.html#a12">00811</a>     wxString GetPrerequisites()<span class="keyword"> const</span>
00812 <span class="keyword">        </span>{ <span class="keywordflow">return</span> m_strPrerequisites; }
00813 
00815     wxArrayString GetParsedPrerequisites() <span class="keyword">const</span>;
00816 
00817 <span class="keyword">private</span>:
00818     DECLARE_CLASS(wxWebUpdatePackage)
00819 };
00820 
00821 
00822 <span class="comment">// a container of wxWebUpdatePackage used by wxWebUpdateXMLScript</span>
00823 <a class="code" href="webupdate_8h.html#a38">WX_DECLARE_USER_EXPORTED_OBJARRAY</a>(wxWebUpdatePackage, wxWebUpdatePackageArray, <a class="code" href="webupdatedef_8h.html#a3">WXDLLIMPEXP_WEBUPDATE</a>);
00824 
00825 
<a name="l00831"></a><a class="code" href="classwxWebUpdateXMLScript.html">00831</a> <span class="keyword">class </span><a class="code" href="webupdatedef_8h.html#a3">WXDLLIMPEXP_WEBUPDATE</a> wxWebUpdateXMLScript : <span class="keyword">public</span> wxXmlDocument
00832 {
00833 <span class="keyword">protected</span>:
00834 
<a name="l00838"></a><a class="code" href="classwxWebUpdateXMLScript.html#p0">00838</a>     <a class="code" href="webupdate_8h.html#a6">wxVersion</a> m_strWebUpdateVersion;
00839 
<a name="l00841"></a><a class="code" href="classwxWebUpdateXMLScript.html#p1">00841</a>     wxString m_strUpdateAvailableMsg;
00842 
<a name="l00844"></a><a class="code" href="classwxWebUpdateXMLScript.html#p2">00844</a>     wxString m_strUpdateNotAvailableMsg;
00845 
00846 <span class="keyword">public</span>:         <span class="comment">// static utilities (used also by wxWebUpdateLocalXMLScript)</span>
00847 
00850     <span class="keyword">static</span> wxString GetPackageID(<span class="keyword">const</span> wxXmlNode *package);
00851 
00854     <span class="keyword">static</span> <a class="code" href="webupdate_8h.html#a44">wxWebUpdateCheckFlag</a> GetWebUpdateVersion(<span class="keyword">const</span> wxXmlNode *root, <a class="code" href="webupdate_8h.html#a6">wxVersion</a> &amp;);
00855 
00857     <span class="keyword">static</span> wxString GetNodeContent(<span class="keyword">const</span> wxXmlNode *node);
00858 
00859 <span class="keyword">protected</span>:      <span class="comment">// internal utilities</span>
00860 
00862     wxWebUpdateActionArray GetActionArray(<span class="keyword">const</span> wxXmlNode *actions) <span class="keyword">const</span>;
00863 
00866     wxWebUpdatePackage *GetPackage(<span class="keyword">const</span> wxXmlNode *package) <span class="keyword">const</span>;
00867 
00869     wxWebUpdateDownload GetDownload(<span class="keyword">const</span> wxXmlNode *latestdownload) <span class="keyword">const</span>;
00870 
00871 <span class="keyword">public</span>:
00872 
00873     wxWebUpdateXMLScript(<span class="keyword">const</span> wxString &amp;strURI = wxEmptyString);
<a name="l00874"></a><a class="code" href="classwxWebUpdateXMLScript.html#a1">00874</a>     <span class="keyword">virtual</span> ~wxWebUpdateXMLScript() {}
00875 
00876 <span class="keyword">public</span>:         <span class="comment">// main functions</span>
00877 
<a name="l00879"></a><a class="code" href="classwxWebUpdateXMLScript.html#a2">00879</a>     <span class="keywordtype">bool</span> IsOk()<span class="keyword"> const</span>
00880 <span class="keyword">        </span>{ <span class="keywordflow">if</span> (!GetRoot() || GetRoot()-&gt;GetName() != wxT(<span class="stringliteral">"webupdate"</span>)) <span class="keywordflow">return</span> FALSE; <span class="keywordflow">return</span> TRUE; }
00881 
00887     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> Load(<span class="keyword">const</span> wxString &amp;uri);
00888 
00892     <span class="keyword">virtual</span> wxWebUpdatePackage *GetPackage(<span class="keyword">const</span> wxString &amp;packagename) <span class="keyword">const</span>;
00893 
00895     <span class="keyword">virtual</span> wxWebUpdatePackageArray GetAllPackages() <span class="keyword">const</span>;
00896 
<a name="l00898"></a><a class="code" href="classwxWebUpdateXMLScript.html#a6">00898</a>     wxString GetUpdateAvailableMsg()<span class="keyword"> const</span>
00899 <span class="keyword">        </span>{ <span class="keywordflow">return</span> m_strUpdateAvailableMsg; }
00900 
<a name="l00902"></a><a class="code" href="classwxWebUpdateXMLScript.html#a7">00902</a>     wxString GetUpdateNotAvailableMsg()<span class="keyword"> const</span>
00903 <span class="keyword">        </span>{ <span class="keywordflow">return</span> m_strUpdateNotAvailableMsg; }
00904 
00905 <span class="keyword">private</span>:
00906     DECLARE_CLASS(wxWebUpdateXMLScript)
00907 };
00908 
00909 <span class="preprocessor">#endif // _WX_WEBUPDATE_H_</span>
00910 <span class="preprocessor"></span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Sat Nov 12 14:55:57 2005 for WebUpdate by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.2 </small></address>
</body>
</html>
